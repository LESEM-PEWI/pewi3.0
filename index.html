<!doctype html>

<!-- Oh my, this is the base page, the page upon which all of PEWI is built.
     Most of the elements are outlined here.
    Some of the more complicated elements are displayed as iframes on top of this page.
    These iframes include the main loading screen, the codex, and much more.

    Basic functionality in terms of javascript begins in startup.html under htmlFrames. Once
    the webGL canvas is created, the startup iframe is made not displayed and the content
    portion of this page is displayed.

    It has been a goal of this page to create as much code reusibility as possilbe. Adding new
    elements should be straightforward.
    -->

<html>

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <title>PEWI Workspace</title>

  <!-- INCLUDES -->
  <!--css-->
  <link rel="stylesheet" type="text/css" href="stylesheet.css">
  <link rel="stylesheet" type="text/css" href="style_left.css">
  <link rel="stylesheet" type="text/css" href="style_right.css">
  <!--favicon-->
  <link rel='shortcut icon' href='./imgs/pewi_favicon.ico' type='image/x-icon' />

  <!--<link rel='shortcut icon' href='./imgs/pewi_favicon.ico' type='image/x-icon' />-->
  <link rel='shortcut icon' href='./imgs/logo_favicon.ico' type='image/x-icon' />

  <!-- three.js framework and javascript libraries -->
  <!-- <script src="./lib/d3.min.js"></script> -->
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="./lib/three.min.js"></script>
  <script src="./lib/controls.js"></script>
  <script src="./lib/jquery-3.2.1.min.js"></script>
  <script src="./lib/stats.min.js"></script>
  <!-- import jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.debug.js"></script>
  <!-- import autotable plug-in for jsPDF -->
  <!-- example&reference: https://github.com/simonbengtsson/jsPDF-AutoTable -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/2.3.2/jspdf.plugin.autotable.js"></script>
  <!-- for svg to canvas conversion -->
  <script type="text/javascript" src="http://canvg.github.io/canvg/rgbcolor.js"></script>
  <script type="text/javascript" src="http://canvg.github.io/canvg/StackBlur.js"></script>
  <script type="text/javascript" src="http://canvg.github.io/canvg/canvg.js"></script>

  <!-- object oriented javascript back-end implementation from PEWI 2.1 -->
  <script src="./back-end/helperMethods.js"></script>
  <script src="./back-end/helperObjects.js"></script>
  <script src="./back-end/mainBE.js"></script>

  <!-- front-end javascript functions for updates with webpage -->
  <script src="./front-end/loader.js"></script>
  <script src="./front-end/resultsDisplay.js"></script>
  <script src="./front-end/gameLogic.js"></script>
  <script src="./front-end/mainFE.js"></script>
  <script src="./front-end/helpersFE.js"info></script>
  <script src="./front-end/levelLoader.js"></script>


  <!--from http://www.schillmania.com/projects/fireworks/ -->
  <script type="text/javascript" src="./lib/fireworks.js"></script>
  <link rel="stylesheet" type="text/css" href="./lib/fireworks.css" media="screen" />

  <!--from http://threejs.org/examples/#canvas_geometry_birds -->
  <script src="./front-end/Bird.js"></script>

  <!--external fonts-->
  <link href='https://fonts.googleapis.com/css?family=Amatic+SC:700' rel='stylesheet' type='text/css'>

  <!-- /INCLUDES -->

</head>

<body id="body">
  <script>
    //Preload gifs and backgrounds on startup
    var img1 = new Image();
    img1.src = "./imgs/loader.gif";
    var img3 = new Image();
    img3.src = "./htmlFrames/imgs/normalBackWithRiver.png";
    var img4 = new Image();
    img4.src = "./htmlFrames/imgs/pewiLogoLarge.png";
    var img5 = new Image();
    img5.src = "./htmlFrames/imgs/water.gif";
    var img2 = new Image();
    img2.src = "./imgs/meadowlarkanimation.gif";
  </script>

  <!-- Create hidden div to contain settings/options for in-game updates -->
  <div id="settingsHolder">
    <input id="firefoxWorkaround"></input>
    <!-- parameters div stores the parameters in options.html -->
    <div id="parameters"></div>
    <!-- print-option-parameters div stores the toggled options in printOptions.html -->
    <div id="print-option-parameters"></div>
  </div>

  <!-- Main webpage element containing pewi -->
  <div id="page">
    <!-- General overlay banner -->
    <div id="genOverlay" style="visibility: hidden;"></div>

    <!-- Add banner for when simulation is about to begin -->
    <div id="overlayContainer" style="visibility:hidden;">
      <div id="overlay">
        <div id="overlay-message">
          <div id="overlayMessage">Click here to begin simulation</div>
        </div>
        <label for="file-upload" id="simUpload">
                <div id="overlay-message-2" onclick="bindUploadFileListener();">
                    <div id = "overlayMessage2">Click here to upload a custom PEWI map</div>
                </div>
            </label>
        <input id="file-upload" type="file" />
      </div>
    </div>

    <!-- Add banner for when simulation is done/paused -->
    <div id="simContainer" style="visibility:hidden;">
      <div class="simOverlay">
        <div id="sim-message-exit">
          <div id="exitSim">Return to Main Menu</div>
        </div>
        <div id="sim-message-repeat">
          <div id="repeatSim">Repeat Simulation</div>
        </div>
      </div>
    </div>

    <!-- Handles the overlay shown during simulations -->
    <script>
      function bindUploadFileListener() {
        //add listener
        $('#file-upload').bind('propertychange change', function(e) {
          parent.uploadClicked(e);
        });
        //small issue: if file selected is same name as previous
        //property change is not triggered, even if file has changed.
      };

      $(document).ready(function() {

        $("#overlay-message").click(function() {
          $("#overlayContainer").css("visibility", "hidden");
          $("#genOverlay").css("visibility", "visible");
          $("#genOverlay").css("background", "transparent");
          runSimulation();
        });

        $("#sim-message-exit").click(function() {
          $("#genOverlay").css("background", "rgba(0, 0, 0, 0.4)");
          $("#simContainer").css("visibility", "hidden");
          $("#sliderCon").css("visibility", "hidden");
          //Reset defaults
          setSimBoolean(false);
          resetPresets();
          resetSlider();
          clearTimers();
          setPause(false);
          setUpload(false);
          showMainMenu();
        });

        $("#sim-message-repeat").click(function() {
          $("#simContainer").css("visibility", "hidden");
          $("#overlayContainer").css("visibility", "visible");
          //Reset defaults
          setSimBoolean(false);
          resetSlider();
          clearTimers();
          setPause(false);
          setUpload(false);
          promptUserSim();
        })
      });
    </script>
     <!-- style="display: inline; visibility: hidden;-->
    <div id = "flyover" class = "fly" > </div>
    <!--Create Glossary button on screen-->
    <div id="indexmenu" onclick="toggleIndex();">Glossary</div>

    <!-- "Undo" icon made by Hadrien on http://www.flaticon.com/authors/hadrien with CC BY 3.0 (https://creativecommons.org/licenses/by/3.0/)-->
    <img id="undoButton" src="./imgs/undo.png" onclick="revertChanges();" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();">

    <!-- **BEGIN Left Side Console**
      with land-type painter, precipitation, ecosystem indicators and feature highlighting functions -->

    <!-- Create left-side console button tabs -->
    <!-- "Pickaxe" by Luke Anthony Firth on http://thenounproject.com with with CC BY 3.0 (https://creativecommons.org/licenses/by/3.0/) / Colors inverted -->
    <div id="toolsButton" class="consoleButton" onclick="roll(1);">
      <img id="pick" src="./imgs/pickOut.png" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();">
    </div>

    <div id="tabButtons" class="tabButtons" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();">

      <!-- "Mountain" by Lee Mette on http://thenounproject.com with with CC BY 3.0 (https://creativecommons.org/licenses/by/3.0/) / Colors inverted -->
      <div id="terrainButton" class="consoleButton" onclick="switchConsoleTab(1);"><img id="terrainImg" class="imgSelected" src="./imgs/terrainIcon.png"></div>
      <!-- "Cloud, raindrops, sun icon" by Yannick Lung (http://yannicklung.com/) with free commercial use / Inverted and resized -->
      <div id="precipButton" class="consoleButton" onclick="switchConsoleTab(2);"><img id="precipImg" class="imgNotSelected" src="./imgs/precipIcon.png"></div>
      <!-- "Calendar tool variant for time administration free icon" by FreePik (http://www.freepik.com), retrived from www.flaticon.com  with free commercial use / Inverted and resized -->
      <div id="yearButton" class="consoleButton" onclick="switchConsoleTab(6);"><img id="calendarImg" class="imgNotSelected" src="./imgs/calendarIcon.png"></div>
      <!-- "Filter, levels, settings icon" by Yash Ranpara (https://www.iconfinder.com/yash11) with free commerical use / Inverted and resized -->
      <div id="levelsButton" class="consoleButton" onclick="switchConsoleTab(3);"><img id="levelsImg" class="imgNotSelected" src="./imgs/levelsIcon.png"></div>
      <!-- "Holiday, ocean, river, sea, summer, water, wave, ..." by Olya Philipenko (https://www.iconfinder.com/hk12215) with free commercial / Inverted and resized -->
      <div id="featuresButton" class="consoleButton" onclick="switchConsoleTab(4);"><img id="featuresImg" class="imgNotSelected" src="./imgs/featuresIcon.png"></div>

      <div id="yieldButton" class="consoleButton" onclick="switchConsoleTab(7);"><img id="yieldImg" class="imgNotSelected" src="./imgs/yieldProductivityIcon.png"></div>

    </div>

    <!-- Create left-side console displays-->
    <div id="leftConsole" class="leftConsole" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();">

      <!-- Land type painter display -->
      <div id="painterTab" class="consoleTab">
        <div id="painterTab-leftcol" class="leftcol">
          <img id="paint1" class="landSelectorIcon iconSelected" src="./imgs/conventionalCorn.png" onclick="changeSelectedPaintTo(1);">
          <img id="paint3" class="landSelectorIcon icon" src="./imgs/conventionalSoybean.png" onclick="changeSelectedPaintTo(3);">
          <img id="paint15" class="landSelectorIcon icon" src="./imgs/fruits.png" onclick="changeSelectedPaintTo(15);">
          <img id="paint8" class="landSelectorIcon icon" src="./imgs/grassHay.png" onclick="changeSelectedPaintTo(8);">
          <img id="paint6" class="landSelectorIcon icon" src="./imgs/permanentPasture.png" onclick="changeSelectedPaintTo(6);">
          <img id="paint14" class="landSelectorIcon icon" src="./imgs/wetland.png" onclick="changeSelectedPaintTo(14);">
          <img id="paint11" class="landSelectorIcon icon" src="./imgs/conventionalForest.png" onclick="changeSelectedPaintTo(11);">
          <img id="paint13" class="landSelectorIcon icon" src="./imgs/shortRotation.png" onclick="changeSelectedPaintTo(13);">

          <!-- multiplayer mode  -->
          <div id="leftPlayerCon"></div>

        </div>

        <div id="painterTab-rightcol" class="rightcol">
          <img id="paint2" class="landSelectorIcon icon" src="./imgs/conservationCorn.png" onclick="changeSelectedPaintTo(2); ">
          <img id="paint4" class="landSelectorIcon icon" src="./imgs/conservationSoybean.png" onclick="changeSelectedPaintTo(4);">
          <img id="paint5" class="landSelectorIcon icon" src="./imgs/alfalfa.png" onclick="changeSelectedPaintTo(5);">
          <img id="paint12" class="landSelectorIcon icon" src="./imgs/herbaceous.png" onclick="changeSelectedPaintTo(12);">
          <img id="paint7" class="landSelectorIcon icon" src="./imgs/rotationalGrazing.png" onclick="changeSelectedPaintTo(7);">
          <img id="paint9" class="landSelectorIcon icon" src="./imgs/prairie.png" onclick="changeSelectedPaintTo(9);">
          <img id="paint10" class="landSelectorIcon icon" src="./imgs/conservationForest.png" onclick="changeSelectedPaintTo(10);">

          <!-- multiplayer mode  -->
          <div id="rightPlayerCon"></div>
        </div>
        <div id="playerOptions" style="display: inline; visibility: hidden;">
          <div id="playerDeleteButton" onclick="deleteAndSort();" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();">
            <img id="playerDeleteImage" style="display:inline-block;" class="playerIcon icon" src="./imgs/deleteYear.png"></div>
          <div id="playerAddButton" onclick="addPlayer(); " onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();">
            <img id="playerAddImage" style="display:inline-block;" class="playerIcon icon" src="./imgs/addYear.png"></div>
        </div>
        <div id="playerResetButton" onclick="resetMultiPlayer();" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();">
          <div id="message">
            <p>RESET</p>
          </div>
          <img id="playerResetImage" class="playerIcon icon" src="./imgs/close_black.png">
        </div>
        <!-- "Combine" button for combining two player's land uses -->
        <div id="combineButton" onclick="combinePlayers();" style="visibility: hidden;">Combine Players</div>
      </div>

      <!-- Precipitation display -->
      <div id="precipTab" class="consoleTab" style="display:none;">
        <form method="precipValues" action=" ">
          <!-- wtf method is called precipValues? -->
          <div id="precipTitle">
            <h3>Precipitation</h3></div>

          <div id="year0PrecipContainer" class="styled-select">
            <h4>Year 0:</h4>
            <select id="year0Precip" class="year-precip-select" onChange="updatePrecip(0); rainOnPewi();">
                <option value=0>24.58</option>
                <option value=1>28.18</option>
                <option value=2>30.39</option>
                <option value=3>32.16</option>
                <option value=4>34.34</option>
                <option value=5>36.47</option>
                <option value=6>45.10</option>
            </select>
          </div>
          <div id="year1PrecipContainer" class="styled-select">
            <h4>Year 1:</h4>
            <select id="year1Precip" class="year-precip-select" onChange="updatePrecip(1); rainOnPewi();">
                <option value=0>24.58</option>
                <option value=1>28.18</option>
                <option value=2>30.39</option>
                <option value=3>32.16</option>
                <option value=4>34.34</option>
                <option value=5>36.47</option>
                <option value=6>45.10</option>
            </select>
          </div>
          <div id="year2PrecipContainer" class="styled-select">
            <h4>Year 2:</h4>
            <select id="year2Precip" class="year-precip-select" onChange="updatePrecip(2); rainOnPewi();">
                <option value=0>24.58</option>
                <option value=1>28.18</option>
                <option value=2>30.39</option>
                <option value=3>32.16</option>
                <option value=4>34.34</option>
                <option value=5>36.47</option>
                <option value=6>45.10</option>
            </select>
          </div>
          <div id="year3PrecipContainer" class="styled-select">
            <h4>Year 3:</h4>
            <select id="year3Precip" class="year-precip-select" onChange="updatePrecip(3); rainOnPewi();">
                <option value=0>24.58</option>
                <option value=1>28.18</option>
                <option value=2>30.39</option>
                <option value=3>32.16</option>
                <option value=4>34.34</option>
                <option value=5>36.47</option>
                <option value=6>45.10</option>
            </select>
          </div>
        </form>

      </div>

      <!-- year display -->
      <div id="yearsTab" class="consoleTab" style="display:none;">
        <!-- Create year buttons -->
        <div id="yearTitle">Year Selection</div>
        <!-- "Exposure, zero icon" by Google Design (https://design.google.com/) used under CC BY (https://creativecommons.org/licenses/by/3.0/) / Inverted from original -->
        <div id="year0Button" class="yearButton" style="display:none;" onclick="transitionToYear(0); switchYearTab(0);" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();"><img id="year0Image" class="icon yearNotSelected" src="./imgs/zero_40px.png"></div>
        <div id="year1Button" class="yearButton" onclick="transitionToYear(1); switchYearTab(1);" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();"><img id="year1Image" class="icon yearSelected" src="./imgs/one.png"></div>
        <div id="year2Button" class="yearButtonHidden" onclick="transitionToYear(2); switchYearTab(2);" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();"><img id="year2Image" class="icon yearImageHidden" src="./imgs/two.png"></div>
        <div id="year3Button" class="yearButtonHidden" onclick="transitionToYear(3); switchYearTab(3);" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();"><img id="year3Image" class="icon yearImageHidden" src="./imgs/three.png"></div>
        <div id="yearAddButton" class="yearButton" onclick="addYearAndTransition();" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();"><img id="yearAddImage" class="icon yearNotSelected" src="./imgs/addYear.png"></div>
      </div>

      <!-- Ecosystem indicator highlighting display -->
      <div id="levelsTab" class="consoleTab" style="display:none;">

        <div id="nitrateDetailsList" class="DetailsListRolled levelDetailsList">
          <center><h1 class="DetailsList-title">Subwatershed Nitrate-N Percent Contribution</h1></center>
          <div class="legendColor" style="background-color: #87ceee">
            <p class="levelsTextDetails">0 - 5 %</p>
          </div>
          <div class="legendColor" style="background-color: #41b7c5">
            <p class="levelsTextDetails">5 - 10 %</p>
          </div>
          <div class="legendColor" style="background-color: #2f7eb7">
            <p class="levelsTextDetails">10 - 20 %</p>
          </div>
          <div class="legendColor" style="background-color: #0053b3">
            <p class="levelsTextDetails">20 - 25 %</p>
          </div>
          <div class="legendColor" style="background-color: #302486">
            <p class="levelsTextDetails">> 25 %</p>
          </div>
        </div>

        <div id="erosionDetailsList" class="DetailsListRolled levelDetailsList">
          <center><h1 class="DetailsList-title">Gross Erosion</h1></center>
          <div class="legendColor" style="background-color: #ffffc9">
            <p class="levelsTextDetails">< 0.5 t/ac/yr</p>
          </div>
          <div class="legendColor" style="background-color: #e3c972">
            <p class="levelsTextDetails">0.5-2 t/ac/yr</p>
          </div>
          <div class="legendColor" style="background-color: #919246">
            <p class="levelsTextDetails">2-3.5 t/ac/yr</p>
          </div>
          <div class="legendColor" style="background-color: #8b4513">
            <p class="levelsTextDetails">3.5-5 t/ac/yr</p>
          </div>
          <div class="legendColor" style="background-color: #654321">
            <p class="levelsTextDetails">> 5 t/ac/yr</p>
          </div>
        </div>

        <div id="phosphorusDetailsList" class="DetailsListRolled levelDetailsList">
          <center><h1 class="DetailsList-title">Phosphorus Index Risk Assessment</h1></center>
          <div class="legendColor" style="background-color: #e6bb00;">
            <p class="levelsTextDetails">Very Low</p>
          </div>
          <div class="legendColor" style="background-color: #c97b08;">
            <p class="levelsTextDetails">Low</p>
          </div>
          <div class="legendColor" style="background-color: #ad490d;">
            <p class="levelsTextDetails">Medium</p>
          </div>
          <div class="legendColor" style="background-color: #9a3010;">
            <p class="levelsTextDetails">High</p>
          </div>
          <div class="legendColor" style="background-color: #871c12;">
            <p class="levelsTextDetails">Very High</p>
          </div>
        </div>

        <!-- "Letter N Ig Icon" by Supratim Nayak (http://www.iconarchive.com/artist/hydrattz.html) with free commercial use -->
        <p class="levelsText">Subwatershed Nitrate-N Percent Contribution</p>
        <img id="nitrateIcon" class="levelsSelectorIcon icon" src="./imgs/N.png" onclick="displayLevels('nitrate');">
        <!-- "Letter E gold Icon" by Supratim Nayak (http://www.iconarchive.com/artist/hydrattz.html) with free commercial use -->
        <p class="levelsText">Gross Erosion</p>
        <img id="erosionIcon" class="levelsSelectorIcon icon" src="./imgs/E.png" onclick="displayLevels('erosion');">
        <!-- "Letter P blue Icon" by Supratim Nayak (http://www.iconarchive.com/artist/hydrattz.html) with free commercial use -->
        <p class="levelsText">Phosphorus Index Risk Assessment</p>
        <img id="phoshorusIcon" class="levelsSelectorIcon icon" src="./imgs/P.png" onclick="displayLevels('phosphorus');">

      </div>

      <!-- Watershed feature display -->
      <div id="featuresTab" class="consoleTab" style="display:none;">
        <div id="floodDetailsList" class="DetailsListRolled physicalDetailsList">
          <center><h1 class="DetailsList-title">Flood Frequency</h1></center>
          <div class="legendColor" style="background-color: #ffffc9;">
            <p class="levelsTextDetails" style="margin-top:10px;">None</p>
          </div>
          <div class="legendColor" style="background-color: #c7eab4;">
            <p class="levelsTextDetails">Rare</p>
          </div>
          <div class="legendColor" style="background-color: #7fcebb;">
            <p class="levelsTextDetails">Occasionally</p>
          </div>
          <div class="legendColor" style="background-color: #41b7c5;">
            <p class="levelsTextDetails">Frequently</p>
          </div>
          <div class="legendColor" style="background-color: #2f7eb7;">
            <p class="levelsTextDetails">Ponded</p>
          </div>
        </div>

        <div id="wetlandsDetailsList"></div>

        <div id="boundaryDetailsList"></div>

        <div id="drainageDetailsList" class="DetailsListRolled physicalDetailsList">
          <center><h1 class="DetailsList-title">Drainage Class</h1></center>
          <div class="legendColor" style="background-color: #0053b3;">
            <p class="levelsTextDetails">Very Poor</p>
          </div>
          <div class="legendColor" style="background-color: #38638b;">
            <p class="levelsTextDetails">Poor</p>
          </div>
          <div class="legendColor" style="background-color: #5e6e71;">
            <p class="levelsTextDetails">Somewhat Poor</p>
          </div>
          <div class="legendColor" style="background-color: #837856;">
            <p class="levelsTextDetails">Moderate / Well</p>
          </div>
          <div class="legendColor" style="background-color: #bc892f;">
            <p class="levelsTextDetails">Excessive</p>
          </div>
        </div>

        <div id="soilDetailsList" class="DetailsListRolled physicalDetailsList">
          <center><h1 class="DetailsList-title">Soil Class</h1></center>
          <div class="legendColor" style="background-color: #097c2f">
            <p class="levelsTextDetails" style="margin-top:10px;">Clarion 138B</p>
          </div>
          <div class="legendColor" style="background-color: #a84597">
            <p class="levelsTextDetails">Buckney 1636</p>
          </div>
          <div class="legendColor" style="background-color: #919246">
            <p class="levelsTextDetails">Canisteo 507</p>
          </div>
          <div class="legendColor" style="background-color: #c97b08">
            <p class="levelsTextDetails">Downs 162D2</p>
          </div>
          <div class="legendColor" style="background-color: #9a3010">
            <p class="levelsTextDetails">Gara-Armstrong 993E2</p>
          </div>
          <div class="legendColor" style="background-color: #c7eab4">
            <p class="levelsTextDetails">Ackmore-Colo 5B</p>
          </div>
          <div class="legendColor" style="background-color: #cc6578">
            <p class="levelsTextDetails">Coland 135</p>
          </div>
          <div class="legendColor" style="background-color: #e6bb00">
            <p class="levelsTextDetails">Tama 120C2</p>
          </div>
          <div class="legendColor" style="background-color: #5e6e71">
            <p class="levelsTextDetails">Nicollet 55</p>
          </div>
          <div class="legendColor" style="background-color: #837856">
            <p class="levelsTextDetails">Okoboji 90</p>
          </div>
          <div class="legendColor" style="background-color: #41b7c5">
            <p class="levelsTextDetails">Tama 120B</p>
          </div>
          <div class="legendColor" style="background-color: #0053b3">
            <p class="levelsTextDetails">Muscatine 119</p>
          </div>
          <div class="legendColor" style="background-color: #87ceee">
            <p class="levelsTextDetails">Nodaway 220</p>
          </div>
        </div>

        <p class="featuresText">Flood Frequency</p><img id="floodFrequency" class="featureSelectorIcon icon" src="./imgs/Icon_Flood_Frequency.svg" onclick="displayLevels('flood');">
        <p class="featuresText">Strategic Wetlands</p><img id="strategicWetlands" class="featureSelectorIcon icon" src="./imgs/Icon_Strategic_Wetlands.svg" onclick="displayLevels('wetlands');">
        <p class="featuresText">Subwatershed Boundaries</p><img id="subwatershedBoundaries" class="featureSelectorIcon icon" src="./imgs/Icon_Subwatershed_Boundaries.svg" onclick="displayLevels('boundary');">
        <p class="featuresText">Drainage Class</p><img id="drainageClass" class="featureSelectorIcon icon" src="./imgs/Icon_Drainage_Class.svg" onclick="displayLevels('drainage');">
        <p class="featuresText">Soil Class</p><img id="soilClass" class="featureSelectorIcon icon" src="./imgs/Icon_Soil_Class.svg" onclick="displayLevels('soil');">
      </div>

      <!--Yield Productivity Overlay Maps -->
      <div id="yieldTab" class="consoleTab" style="display: none;">
        <div id="cornDetailsList" class="DetailsListRolled yieldDetailsList">
          <center><h1 class="DetailsList-title">Corn Grain Yield Key</h1></center>
          <div class="legendColor" style="background-color: #ffffc9;">
            <p class="levelsTextDetails">0 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #e3c972;">
            <p class="levelsTextDetails">11.2-13.2 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #e6bb00;">
            <p class="levelsTextDetails">13.2-13.9 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #bc892f;">
            <p class="levelsTextDetails">13.9-15.1 Mg/ha/yr</p>
          </div>

          <center><h1 class="DetailsList-title">Corn Grain Precipitation Factor</h1></center>
          <center><h1 class="DetailsList-title">At Different Precipitation Levels</h1></center>

          <table id="yieldTable">
            <tr>
              <th>Yield Type Precipitation Factor</th><th>Precipitation Level (in)/yr</th>
            </tr>
            <tr>
              <td>0.75</td><td>24.6</td>
            </tr>
            <tr>
              <td>0.90</td><td>28.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>30.4</td>
            </tr>
            <tr>
              <td>1.00</td><td>32.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>34.3</td>
            </tr>
            <tr>
              <td>0.90</td><td>36.5</td>
            </tr>
            <tr>
              <td>0.75</td><td>45.1</td>
            </tr>
          </table>
        </div>

        <div id="soybeanDetailsList" class="DetailsListRolled yieldDetailsList">
          <center><h1 class="DetailsList-title">Soybean Yield Key</h1></center>
          <div class="legendColor" style="background-color: #ffffff;">
            <p class="levelsTextDetails">0 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #ccffcc;">
            <p class="levelsTextDetails">3.50-3.90 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #66ff66;">
            <p class="levelsTextDetails">3.90-4.30 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #00cc00;">
            <p class="levelsTextDetails">4.30-4.70 Mg/ha/yr</p>
          </div>

          <center><h1 class="DetailsList-title">Soybean Precipitation Factor</h1></center>
          <center><h1 class="DetailsList-title">At Different Precipitation Levels</h1></center>

          <table id="yieldTable">
            <tr>
              <th>Yield Type Precipitation Factor </th><th>Precipitation Level (in)/yr</th>
            </tr>
            <tr>
              <td>0.75</td><td>24.6</td>
            </tr>
            <tr>
              <td>0.90</td><td>28.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>30.4</td>
            </tr>
            <tr>
              <td>1.00</td><td>32.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>34.3</td>
            </tr>
            <tr>
              <td>0.90</td><td>36.5</td>
            </tr>
            <tr>
              <td>0.75</td><td>45.1</td>
            </tr>
          </table>
        </div>

        <div id="fruitDetailsList" class="DetailsListRolled yieldDetailsList">
          <center><h1 class="DetailsList-title">Mixed Fruit and Vegetable Yield Key</h1></center>
          <div class="legendColor" style="background-color: #ff4000;">
            <p class="levelsTextDetails">6.58 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #e6bb00;">
            <p class="levelsTextDetails">13.98 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #66ff66;">
            <p class="levelsTextDetails">14.80 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #aa4497;">
            <p class="levelsTextDetails">16.45 Mg/ha/yr</p>
          </div>

          <center><h1 class="DetailsList-title">Mixed Fruit and Vegetable Precipitation Factor</h1></center>
          <center><h1 class="DetailsList-title">At Different Precipitation Levels</h1></center>

          <table id="yieldTable">
            <tr>
              <th>Yield Type Precipitation Factor </th><th>Precipitation Level (in)/yr</th>
            </tr>
            <tr>
              <td>1.00</td><td>24.6</td>
            </tr>
            <tr>
              <td>1.00</td><td>28.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>30.4</td>
            </tr>
            <tr>
              <td>1.00</td><td>32.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>34.3</td>
            </tr>
            <tr>
              <td>0.90</td><td>36.5</td>
            </tr>
            <tr>
              <td>0.75</td><td>45.1</td>
            </tr>
          </table>
        </div>

        <div id="cattleDetailsList" class="DetailsListRolled yieldDetailsList">
          <center><h1 class="DetailsList-title">Cattle Yield Key</h1></center>
          <div class="legendColor" style="background-color: #ffffff;">
            <p class="levelsTextDetails">3.4-4.0 animals/acre/yr</p>
          </div>
          <div class="legendColor" style="background-color: #CECACA;">
            <p class="levelsTextDetails">4.0-5.4 animals/acre/yr</p>
          </div>
          <div class="legendColor" style="background-color: #5e6e71;">
            <p class="levelsTextDetails">5.4-6.1 animals/acre/yr</p>
          </div>
          <div class="legendColor" style="background-color: #000000;">
            <p class="levelsTextDetails">6.1-6.7 animals/acre/yr</p>
          </div>

          <center><h1 class="DetailsList-title">Cattle Precipitation Factor</h1></center>
          <center><h1 class="DetailsList-title">At Different Precipitation Levels</h1></center>

          <table id="yieldTable">
            <tr>
              <th>Yield Type Precipitation Factor </th><th>Precipitation Level (in)/yr</th>
            </tr>
            <tr>
              <td>0.95</td><td>24.6</td>
            </tr>
            <tr>
              <td>1.00</td><td>28.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>30.4</td>
            </tr>
            <tr>
              <td>1.00</td><td>32.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>34.3</td>
            </tr>
            <tr>
              <td>1.00</td><td>36.5</td>
            </tr>
            <tr>
              <td>0.95</td><td>45.1</td>
            </tr>
          </table>
        </div>

        <div id="alfalfaDetailsList" class="DetailsListRolled yieldDetailsList">
          <center><h1 class="DetailsList-title">Alfalfa Yield Key</h1></center>
          <div class="legendColor" style="background-color: #cc6578;">
            <p class="levelsTextDetails">8.07-9.42 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #aa4497;">
            <p class="levelsTextDetails">9.42-12.6 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #8B008B;">
            <p class="levelsTextDetails">12.6-14.6 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #862254;">
            <p class="levelsTextDetails">14.6-15.5 Mg/ha/yr</p>
          </div>

          <center><h1 class="DetailsList-title">Alfalfa Precipitation Factor</h1></center>
          <center><h1 class="DetailsList-title">At Different Precipitation Levels</h1></center>

          <table id="yieldTable">
            <tr>
              <th>Yield Type Precipitation Factor </th><th>Precipitation Level (in)/yr</th>
            </tr>
            <tr>
              <td>0.95</td><td>24.6</td>
            </tr>
            <tr>
              <td>1.00</td><td>28.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>30.4</td>
            </tr>
            <tr>
              <td>1.00</td><td>32.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>34.3</td>
            </tr>
            <tr>
              <td>1.00</td><td>36.5</td>
            </tr>
            <tr>
              <td>0.95</td><td>45.1</td>
            </tr>
          </table>
        </div>

        <div id="grasshayDetailsList" class="DetailsListRolled yieldDetailsList">
          <center><h1 class="DetailsList-title">Grass Hay Yield Key</h1></center>

          <div class="legendColor" style="background-color: #d9ff66;">
            <p class="levelsTextDetails">8.07-9.42 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #66ff66;">
            <p class="levelsTextDetails">9.42-12.6 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #00ff00;">
            <p class="levelsTextDetails">12.6-14.6 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #187336;">
            <p class="levelsTextDetails">14.6-15.5 Mg/ha/yr</p>
          </div>

          <center><h1 class="DetailsList-title">Grass Hay Precipitation Factor</h1></center>
          <center><h1 class="DetailsList-title">At Different Precipitation Levels</h1></center>

          <table id="yieldTable">
            <tr>
              <th>Yield Type Precipitation Factor </th><th>Precipitation Level (in)/yr</th>
            </tr>
            <tr>
              <td>0.95</td><td>24.6</td>
            </tr>
            <tr>
              <td>1.00</td><td>28.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>30.4</td>
            </tr>
            <tr>
              <td>1.00</td><td>32.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>34.3</td>
            </tr>
            <tr>
              <td>1.00</td><td>36.5</td>
            </tr>
            <tr>
              <td>0.95</td><td>45.1</td>
            </tr>
          </table>
        </div>

        <div id="switchgrassDetailsList" class="DetailsListRolled yieldDetailsList">
          <center><h1 class="DetailsList-title">Switchgrass Yield Key</h1></center>

          <div class="legendColor" style="background-color: #66ff66;">
            <p class="levelsTextDetails">4.39-5.29 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #33cc33;">
            <p class="levelsTextDetails">5.29-5.83 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #1f7a1f;">
            <p class="levelsTextDetails">5.83-6.25 Mg/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #145214;">
            <p class="levelsTextDetails">6.25-6.61 Mg/ha/yr</p>
          </div>

          <center><h1 class="DetailsList-title">Switchgrass Precipitation Factor</h1></center>
          <center><h1 class="DetailsList-title">At Different Precipitation Levels</h1></center>

          <table id="yieldTable">
            <tr>
              <th>Yield Type Precipitation Factor </th><th>Precipitation Level (in)/yr</th>
            </tr>
            <tr>
              <td>0.95</td><td>24.6</td>
            </tr>
            <tr>
              <td>1.00</td><td>28.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>30.4</td>
            </tr>
            <tr>
              <td>1.00</td><td>32.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>34.3</td>
            </tr>
            <tr>
              <td>1.00</td><td>36.5</td>
            </tr>
            <tr>
              <td>0.95</td><td>45.1</td>
            </tr>
          </table>
        </div>

        <div id="woodDetailsList" class="DetailsListRolled yieldDetailsList">
          <center><h1 class="DetailsList-title">Wood Yield Key</h1></center>
          <div class="legendColor" style="background-color: #f2e6d9;">
            <p class="levelsTextDetails">0.50-0.73 m3/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #d9b38c;">
            <p class="levelsTextDetails">0.73-1.02 m3/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #ac7339;">
            <p class="levelsTextDetails">1.02-1.43 m3/ha/yr</p>
          </div>
          <div class="legendColor" style="background-color: #734d26;">
            <p class="levelsTextDetails">1.43-1.60 m3/ha/yr</p>
          </div>

          <center><h1 class="DetailsList-title">Wood Precipitation Factor</h1></center>
          <center><h1 class="DetailsList-title">At Different Precipitation Levels</h1></center>

          <table id="yieldTable">
            <tr>
              <th>Yield Type Precipitation Factor </th><th>Precipitation Level (in)/yr</th>
            </tr>
            <tr>
              <td>1.00</td><td>24.6</td>
            </tr>
            <tr>
              <td>1.00</td><td>28.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>30.4</td>
            </tr>
            <tr>
              <td>1.00</td><td>32.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>34.3</td>
            </tr>
            <tr>
              <td>1.00</td><td>36.5</td>
            </tr>
            <tr>
              <td>1.00</td><td>45.1</td>
            </tr>
          </table>
        </div>

        <div id="shortDetailsList" class="DetailsListRolled yieldDetailsList">
          <center><h1 class="DetailsList-title">Short-Rotation Woody Biomass Yield Key</h1></center>
          <div class="legendColor" style="background-color: #734D26;">
            <p class="levelsTextDetails">608.6 tons/acre/yr</p>
          </div>

          <center><h1 class="DetailsList-title">Short-Rotation Woody Biomass Yield Precipitation Factor</h1></center>
          <center><h1 class="DetailsList-title">At Different Precipitation Levels</h1></center>

          <table id="yieldTable">
            <tr>
              <th>Yield Type Precipitation Factor </th><th>Precipitation Level (id)/yr</th>
            </tr>
            <tr>
              <td>1.00</td><td>24.6</td>
            </tr>
            <tr>
              <td>1.00</td><td>28.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>30.4</td>
            </tr>
            <tr>
              <td>1.00</td><td>32.2</td>
            </tr>
            <tr>
              <td>1.00</td><td>34.3</td>
            </tr>
            <tr>
              <td>1.00</td><td>36.5</td>
            </tr>
            <tr>
              <td>1.00</td><td>45.1</td>
            </tr>
          </table>
        </div>

        <div class="leftcol">
          <img id="cornClass" class="yieldSelectorIcon icon" src="./imgs/cornGrainIcon.png" title="Corn Grain" onclick="displayLevels('corn');">
          <img id="fruitClass" class="yieldSelectorIcon icon" src="./imgs/fruitIcon.png" title="Mixed Fruits and Vegetables" onclick="displayLevels('fruit');">
          <img id="alfalfaClass" class="yieldSelectorIcon icon" src="./imgs/alfalfaIcon.png" title="Alfalfa" onclick="displayLevels('alfalfa');">
          <img id="switchGrassClass" class="yieldSelectorIcon icon" src="./imgs/switchGrassIcon.png" title="Switch Grass" onclick="displayLevels('switchgrass');">
          <img id="shortClass" class="yieldSelectorIcon icon" src="./imgs/woodyBiomassIcon.png" title="Woody Biomass" onclick="displayLevels('short');">
        </div>
        <div class="rightcol">
          <img id="soyClass" class="yieldSelectorIcon icon" src="./imgs/soybeanIcon.png" title="Soybean" onclick="displayLevels('soybean');">
          <img id="cattleClass" class="yieldSelectorIcon icon" src="./imgs/cowIcon.png" title="Cattle" onclick="displayLevels('cattle');">
          <img id="grassHayClass" class="yieldSelectorIcon icon" src="./imgs/grassHayIcon.png" title="GrassHay" onclick="displayLevels('grasshay');">
          <img id="woodClass" class="yieldSelectorIcon icon" src="./imgs/woodIcon.png" title="Wood" onclick="displayLevels('wood');">
        </div>

      </div>

    </div>

    <!-- painter brush -->
    <div id="settingsTab">
      <img id="cellPaint" class="painterIcon iconSelected" src="./imgs/hoverPainter.png" onclick="painterSelect(1);">
      <img id="gridPaint" class="painterIcon icon" src="./imgs/gridPainter.png" onclick="painterSelect(2);">

    </div>

    <!-- END left console, there is a lot happening there -->

    <!-- **BEGIN Right Side Component** -->

    <!-- Create results button -->
    <div id="resultsButton" class="resultsButtonRolled" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();" onclick="resultsStart() ;"><img src="./imgs/resultsIcon.png"></div>
    <!--img src="./imgs/backgroundinfo.png"></div>-->

    <!-- Create dialogue popup box (message box) -->
    <!-- "Bubble, speech icon" by http://www.iconsolid.com/ with free commercial usage / Inverted from original and resized -->
    <div id="dialogueButton" class="dialogueButtonRolled" onclick="togglePopupDisplay();"><img src="./imgs/dialogue.png" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();"></div>
    <div id="popup" class="popupHidden" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();">
      <div id="nextLevelButton" class="moveButtonHidden" onclick="loadLevel(levelGlobal + 1);">Next Level</div>
      <div id="mainMenuButton" class="moveButtonHidden" onclick="showMainMenu();">Main Menu</div>
      <p id="popupText"></p>
    </div>

    <!--Chat box for Index information -->
    <div id="backgroundInfoButton" class="backgroundInfoButton" onclick="toggleBackgroundInfoDisplay();"><img src="./imgs/indexIcon.png"></div>
    <div id="backgroundInfoBox" class="backgroundInfoBox">
      <p id="indexPopupText" class="indexPopupText"></p>
    </div>

    <!-- **END Right Side Component** -->

    <!-- Create buttons in upper right corner: upperHud-->
    <img id="pewiLogo" src="./imgs/updatedPewiLogo.png">
    <img id="logoBase" src="./imgs/inGameLogo.png">
    <img id="uploadDownloadButton" class="upperButton" src="./imgs/uploadDownloadIcon.png" onclick="showUploadDownload();" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();">
    <img id="creditsButton" class="upperButton" src="./imgs/credits_button.png" onclick="showCredits();" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();">
    <img id="recordIcon" class="upperButton" style="visibility:hidden;" width="40px" src="./imgs/recordingIcon.gif">
    <img id="homebutton" class="upperButton" src="imgs/Home_Icon.png" onclick="toggleEscapeFrame();" >
    <img id="printButton" class = "upperButton" src="imgs/Button_Print.svg" onclick="startPrintOptions();">


    <!-- "Undo" icon made by Hadrien on http://www.flaticon.com/authors/hadrien with CC BY 3.0 (https://creativecommons.org/licenses/by/3.0/)-->
    <img id="undoButton" class="upperButton" width="40px" src="./imgs/undo.png" onclick="revertChanges();" onmouseover="toggleChangeLandType();" onmouseout="toggleChangeLandType();">

    <!-- order now becomes important to make sure elements stack and cover correctly -->

    <!-- Add heads up display in lower left corner -->
    <footer id="bottomHUD" class="bottomHUD">
      <div id="sliderCon" style="visibility: hidden">
        <label for="simSlider">Simulation Time</label>
        <input id="simSlider" type="range" min="0" max="100" value="0" onclick="updateSim(this.value)">
          <img id="pausePlay" src="imgs/pauseButton.png" onclick="togglePausePlay();">
        <output for="simSlider" id="timer">00:00:00</output>
      </div>
      <p id="currentInfo">
    </footer>

    <!-- div which follows cursor for delayed hover information -->
    <div id="hover-div">
      <p id="hover-info"></p>
    </div>

    <!-- Create iFrames for credits, upload/download, and codex -->
    <div id="modalCreditsFrame"><iframe id="creditsFrame" style="display:none;" src="./htmlFrames/credits.html"></iframe></div>
    <img id="closeCredits" class="closeButton" style="display:none;" src="./imgs/close_black.png" onclick="closeCreditFrame() ;">
    <div id="modalUploadFrame"><iframe id="uploadDownloadFrame" style="display:none;" src="./htmlFrames/uploadDownload.html"></iframe></div>
    <img id="closeUploadDownload" class="closeButton" style="display:none;" src="./imgs/close_black.png" onclick="closeUploadDownloadFrame();">
    <div id="modalCodexFrame"><iframe id="index" src="./modules/codex/codex.html" allowfullscreen="allowfullscreen"></iframe></div>
    <!-- index iframe has its own close button -->

    <!-- Include fireworks javascript library -->
    <div id="fireworks-template">
      <div id="fw" class="firework"></div>
      <div id="fp" class="fireworkParticle"><img src="./imgs/particles.gif" alt="" /></div>
    </div>
    <div id="fireContainer"></div>

    <!-- Place meadowlark gif off page -->
    <img id="meadowlark" class="meadowlarkhidden" src="./imgs/meadowlarkanimation.gif"></div>

  <!-- Create iframes for the results, options and multiplayer screens -->
  <div id="modalResultsFrame"><iframe id="resultsFrame" class="resultsFrame" src="./htmlFrames/results.html"></iframe></div>
  <img id="closeResults" class="closeButton" style="opacity:0; visibility:hidden; right:9%;" src="./imgs/close_black.png" onclick="resultsEnd() ;">
  <iframe id="multiplayer" class="fullPageIframe" src="./htmlFrames/multiDownload.html"></iframe>
  <iframe id="options" class="fullPageIframe" src="./htmlFrames/options.html"></iframe>
  <iframe id="printOptions" class="fullPageIframe" src="./htmlFrames/printOptions.html"></iframe>

  </div>
  <!-- End of page div, this is all of the meaningful content for in-game -->

  <!-- the modal frame covers the page with semi-opaque layer, and escape options -->

  <div id="modalEscapeFrame">
    <div id="escapeMenu">
      <div class="mainEscapeButton" id="directoryButton" onclick="toggleEscapeFrame(); toggleIndex() ;">Glossary</div>
      <div class="mainEscapeButton" id="optionsButton" onclick="toggleEscapeFrame(); startOptions();">Instructor Options</div>
      <!--The hover options feature is currently in the Options menu, but can be changed -->
      <!--<div class="mainEscapeButton" id="userSettingsButton" onclick="toggleEscapeFrame(); startOptions();">User Settings</div>-->
      <div class="mainEscapeButton" id="exitToMenuButton" onclick="confirmEscape();">Main Menu</div>
      <div id="confirmEscape">
        Are you sure you want to exit? All your progress will be lost.
        <div class="mainEscapeButton" id="yesConfirmEscape" onclick="showMainMenu(); toggleEscapeFrame();">Yes</div>
        <div class="mainEscapeButton" id="noConfirmEscape" onclick="toggleEscapeFrame();">No</div>
      </div>
    </div>
  </div>

  <!-- Javascript to stop event propogation for bug fix in modalEscapeFrame (above) -->
  <script>
    //prevent modalEscapeFrame from being clicked on when using the buttons stored in the frame
    $("#escapeMenu").click(function(e) {
      e.stopPropagation();
      return false;
    });

    // Prompt save changes before user exit the program
    var page = document.getElementById("page");

    $(window).bind("beforeunload", function(event) {
      if (page.style.visibility == 'visible') {
        // on the main page, ask the user to save changes
        showUploadDownload();
        return "Are you sure to leave? Make sure if you saved changes.";
      } else {
        // not on the main page, exit the app directly
        return;
      }

    });

    // // for different browsers
    // $(window).bind("onunload", function(event) {
    // if (page.style.visibility == 'hidden') {
    //   // not on the main page, exit the app directly
    //
    //   page = null; // XXX should clean more objects (everything) here
    //
    //   return ;
    // }
    //
    // // on the main page, ask the user to save changes
    // showUploadDownload();
    //   confirm("Are you sure to leave? Make sure if you saved changes.");
    // });
  </script>

  <!-- Add spinning circle loading gif, this loader is visible during transitions-->
  <div id="loading">
    <div id="loadingContainer">
      <!-- center is not exactly optimal html, but will do for now -->
      <center>
        <br><br>
        <img src="./imgs/loader.gif">
      </center>
    </div>
  </div>

  <!-- Add div and iFrame for the startup page -->
  <div id="startupSequence" style="position:absolute; width:100%; height:100%;">
    <iframe id="startUpFrame" src="./htmlFrames/startup.html" style="width:100%; height:100%;"></iframe>
  </div>
</body>

</html>
